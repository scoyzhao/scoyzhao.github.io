<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- iOS Safari -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<!-- Chrome, Firefox OS and Opera Status Bar Color -->
<meta name="theme-color" content="#FFFFFF">
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css">
<link rel="stylesheet" type="text/css"
  href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.19.0/themes/prism.min.css">
<link rel="stylesheet" type="text/css" href="css/SourceSansPro.css">
<link rel="stylesheet" type="text/css" href="css/theme.css">
<link rel="stylesheet" type="text/css" href="css/notablog.css">
<!-- Favicon -->

  <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;📖&lt;/text&gt;&lt;/svg&gt;">

<style>
  :root {
    font-size: 20px;
  }
</style>
  <title>this&nbsp;|&nbsp;Zhao’s Blog</title>
  <meta property="og:type" content="blog">
  <meta property="og:title" content="this">
  
    <meta name="description" content="关于this的知识总结">
    <meta property="og:description" content="关于this的知识总结">
  
  
    <meta property="og:image" content="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;😀&lt;/text&gt;&lt;/svg&gt;">
  
  <style>
    .DateTagBar {
      margin-top: 1.0rem;
    }
  </style>
</head>

<body>
  <nav class="Navbar">
  <a href="index.html">
    <div class="Navbar__Btn">
      
        <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;📖&lt;/text&gt;&lt;/svg&gt;"></span>&nbsp;
      
      <span>Home</span>
    </div>
  </a>
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <span class="Navbar__Delim">&centerdot;</span>
      <a href="about.html">
        <div class="Navbar__Btn">
          
            <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;😀&lt;/text&gt;&lt;/svg&gt;"></span>&nbsp;
          
          <span>About</span>
        </div>
      </a>
    
  
</nav>
  <header class="Header">
    
    <div class="Header__Spacer Header__Spacer--NoCover">
    </div>
    
      <div class="Header__Icon">
        <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;😀&lt;/text&gt;&lt;/svg&gt;"></span>
      </div>
    
    <h1 class="Header__Title">this</h1>
    
      <div class="DateTagBar">
        
          <span class="DateTagBar__Item DateTagBar__Date">Posted on Sat, Feb 25, 2023</span>
        
        
          <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--yellow">
            <a href="tag/JavaScript.html">JavaScript</a>
          </span>
        
          <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--blue">
            <a href="tag/最后一次整理.html">最后一次整理</a>
          </span>
        
      </div>
    
  </header>
  <article id="https://www.notion.so/306eda7270ff4e998272de4631566434" class="PageRoot PageRoot--FullWidth"><ul id="https://www.notion.so/b9e6990b8e9642eb8f220b9ffc096a1c" class="ColorfulBlock ColorfulBlock--ColorGray TableOfContents"><li class="TableOfContents__Item"><a href="#https://www.notion.so/0828e3003f5c49f2be4f0d836c058e73"><div style="margin-left:0px"><span class="SemanticStringArray"><span class="SemanticString">this</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/0a3ce36465894cdab1ee057cbc9535ca"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">为什么要用this</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/ac391b90141e4f54bfc8ae316eb0f450"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">this是什么</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/d676d9f3bfbf425391f5d22ad98b19e2"><div style="margin-left:0px"><span class="SemanticStringArray"><span class="SemanticString">绑定规则</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/a2ccae8787724ee599726cfeb5c8d037"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">默认绑定 - 指向全局对象</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/bdb2ab7dd75c40b2b424b5d89d658968"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">隐式绑定</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/3caaa409c3104aab8756ea8a7b3c2c92"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString">隐式丢失</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/225d1f59eee5476e8bb6f464ce2ce415"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">显式绑定</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/9b6808acce1842faaf84ea1354ff5abb"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString">硬绑定</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/c85ba6b6400b434883442d9d5017c84d"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">new绑定</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/d46fab1c0d664579b2612d8b1c2f5b2f"><div style="margin-left:0px"><span class="SemanticStringArray"><span class="SemanticString">优先级</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/7083bbe3523d4f13afe41aa7112c80d4"><div style="margin-left:0px"><span class="SemanticStringArray"><span class="SemanticString">绑定例外</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/96ed6388ed1d46d295e21b6c16947d3b"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">被忽视的this</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/da76b6942f064ddd9de7cca1faf0247e"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString">更安全的this</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/006ad4b5dfca42978d576a1044a1310b"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">间接引用</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/6f0e50b7382a44baac702140e9a80392"><div style="margin-left:0px"><span class="SemanticStringArray"><span class="SemanticString">this词法-箭头函数</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/cd84ebf0a103424a869c69a62c704513"><div style="margin-left:0px"><span class="SemanticStringArray"><span class="SemanticString">知识补充</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/ac1181d3150847e3b7e22f0c126e91d9"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">手写bind，call，apply</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/416d99f2362f422db3b0ab9ee5c8fdf6"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString">bind</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/9b26e9acbc4b4af4bc5acc6beea1b251"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString">call</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/d9b41da25be443f490fd265124c40330"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString">apply</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/9f44fedeb0fd4be3ba1e220304dc6452"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">TODO</span></span></div></a></li></ul><div id="https://www.notion.so/17254d8262ca429f989a5d3c2c7a9021" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><h1 id="https://www.notion.so/0828e3003f5c49f2be4f0d836c058e73" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/0828e3003f5c49f2be4f0d836c058e73"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">this</span></span></h1><h2 id="https://www.notion.so/0a3ce36465894cdab1ee057cbc9535ca" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/0a3ce36465894cdab1ee057cbc9535ca"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">为什么要用this</span></span></h2><div id="https://www.notion.so/8179285b0f3f4f6cb4c7b1fde5b5e4e5" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">this提供了一种优雅的方式来隐式的传递一个对象引用（上下文），使代码简介并且易于复用</span></span></p></div><h2 id="https://www.notion.so/ac391b90141e4f54bfc8ae316eb0f450" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/ac391b90141e4f54bfc8ae316eb0f450"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">this是什么</span></span></h2><div id="https://www.notion.so/e1d5b553bfff4acd8519c5efa2de5a67" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">this是在</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">运行时</code></span><span class="SemanticString">进行绑定的，并不是在编写时绑定的，它的上下文取决于</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">函数调用时的各种条件。</code></span><span class="SemanticString"> 也就是说，它指向什么完全取决于函数在哪里调用</span></span></p></div><h1 id="https://www.notion.so/d676d9f3bfbf425391f5d22ad98b19e2" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/d676d9f3bfbf425391f5d22ad98b19e2"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">绑定规则</span></span></h1><h2 id="https://www.notion.so/a2ccae8787724ee599726cfeb5c8d037" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/a2ccae8787724ee599726cfeb5c8d037"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">默认绑定 - 指向全局对象</span></span></h2><div id="https://www.notion.so/f04c86f228e14f96b793707f579923db" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">使用不带任何修饰的函数引用调用，只能使用默认绑定，无法使用其他规则</span></span></p></div><div id="https://www.notion.so/073e6b5cff0244c98183a9597ee98bd1" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">值得注意的是，</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">严格模式</code></span><span class="SemanticString">不能将全局对象进行默认绑定</span></span></p></div><h2 id="https://www.notion.so/bdb2ab7dd75c40b2b424b5d89d658968" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/bdb2ab7dd75c40b2b424b5d89d658968"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">隐式绑定</span></span></h2><div id="https://www.notion.so/a056309e307148149cb6757d12da7b03" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">考虑调用位置是否有上下文对戏那个，或者说是否被某个对象拥有或者包含，</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">不过这种说法可能会造成误导</code></span></span></p></div><pre id="https://www.notion.so/ffd4454e84ff456cbb5d0fd421738e43" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>a<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
	<span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
	<span class="token literal-property property">foo</span><span class="token operator">:</span> foo<span class="token punctuation">,</span>
<span class="token punctuation">}</span>

obj<span class="token punctuation">.</span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 2</span></span></span></span></code></pre><div id="https://www.notion.so/6c0357a152ef49db88111e0ba738253a" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">严格来说，foo函数不属于obj对象。然而调用位置是会使</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">使用obj的上下文对象</code></span><span class="SemanticString"> ，这里可以说是函数被调用时，被obj对象拥有或包含</span></span></p></div><div id="https://www.notion.so/93bf109a76864a52a51770aac704f120" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">当函数引用的时候，如果有上下文对象的时候，</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">隐式规则</code></span><span class="SemanticString">会把this绑定到这个上下文对象</span></span></p></div><div id="https://www.notion.so/d8cd0582d86443f884810ba1364bef6a" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">对象属性的引用链，</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">只有上一层或者说最后一层</code></span><span class="SemanticString">所在的调用位置起作用：</span></span></p></div><pre id="https://www.notion.so/2803f3e293fa4778b1db5b2f5632ca98" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>a<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> obj1 <span class="token operator">=</span> <span class="token punctuation">{</span>
	<span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
	<span class="token literal-property property">foo</span><span class="token operator">:</span> foo<span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
	<span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
	<span class="token literal-property property">obj1</span><span class="token operator">:</span> obj1<span class="token punctuation">,</span>
<span class="token punctuation">}</span>

obj<span class="token punctuation">.</span>obj1<span class="token punctuation">.</span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 3</span></span></span></span></code></pre><h3 id="https://www.notion.so/3caaa409c3104aab8756ea8a7b3c2c92" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/3caaa409c3104aab8756ea8a7b3c2c92"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">隐式丢失</span></span></h3><div id="https://www.notion.so/50bcb5737a85416f8f3b00977c5e56c4" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">丢失后会使用默认规则</span></span></p></div><pre id="https://www.notion.so/8fd30dc143444b49b98f13e3cf2ac06a" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>a<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
	<span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
	<span class="token literal-property property">foo</span><span class="token operator">:</span> foo<span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> bar <span class="token operator">=</span> obj<span class="token punctuation">.</span>foo
<span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// undefined</span></span></span></span></code></pre><div id="https://www.notion.so/26d2be77799341eb9457788650ffaebe" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">虽然bar时obj.foo的引用，但是实际上他是foo函数本身</span></span></p></div><div id="https://www.notion.so/82802e913ee247c2993d419bd60e4b70" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">回调函数同样存在：</span></span></p></div><pre id="https://www.notion.so/579c496d5cc34d0098b8604e1a9f2496" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>a<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
	<span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
	<span class="token literal-property property">foo</span><span class="token operator">:</span> foo<span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">doFoo</span><span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">doFoo</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>foo<span class="token punctuation">)</span> <span class="token comment">// undefined</span></span></span></span></code></pre><div id="https://www.notion.so/f462b777d3c54a13a36a83a875eaaebb" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">参数传递实际上就是一种</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">隐式赋值</code></span><span class="SemanticString"> ，传入Javascript内置函数（例如setTimeout）会得到同样的结果</span></span></p></div><div id="https://www.notion.so/4739adbd6da84e1dbf805be4c4f614aa" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">这样是很头疼的，我们期望this按照我们的想法来固定：</span></span></p></div><h2 id="https://www.notion.so/225d1f59eee5476e8bb6f464ce2ce415" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/225d1f59eee5476e8bb6f464ce2ce415"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">显式绑定</span></span></h2><div id="https://www.notion.so/531c5d18ff06410792cecb3c2bdea576" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">可以通过</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">apply和call</code></span><span class="SemanticString">方法来改变this的指向：他们第一个参数是一个对象，是给this准备的，接着在调用函数的时候将其绑定在this上，因此可以直接指定this的指向</span></span></p></div><pre id="https://www.notion.so/10d5277b136c4b4a94244b69ce452bfa" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>a<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
	<span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
	<span class="token literal-property property">foo</span><span class="token operator">:</span> foo<span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token function">foo</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">)</span></span></span></span></code></pre><div id="https://www.notion.so/56b37c46d3d24b569846b9895c08a556" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">然而，还是存在绑定丢失的问题?</span></span></p></div><h3 id="https://www.notion.so/9b6808acce1842faaf84ea1354ff5abb" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/9b6808acce1842faaf84ea1354ff5abb"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">硬绑定</span></span></h3><div id="https://www.notion.so/2fc01077748f4451882430f4d92aae2c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">一个典型的场景就是创建</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">包裹函数</code></span><span class="SemanticString">：</span></span></p></div><pre id="https://www.notion.so/1f071809716b49189c4b9a3e7a393250" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>a<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
	<span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> <span class="token function-variable function">bar</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token function">foo</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> arguments<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token comment">// 2</span></span></span></span></code></pre><div id="https://www.notion.so/e15981c3c0114185bfa3be16a79ae28f" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">进而把它封装成一个可以服用的</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">辅助函数</code></span><span class="SemanticString">：</span></span></p></div><pre id="https://www.notion.so/0babae087be048ce9dc5b4109f84ce6f" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token keyword">function</span> <span class="token function">bind</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> arguments<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span></span></span></span></code></pre><div id="https://www.notion.so/66f493efd70a47f5b4c86ca6731e08d5" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">因为比较常用，所以这也就是</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">bind</code></span><span class="SemanticString">的来源：它与apply和call不同的地方在于，它绑定完不会立即执行</span></span></p></div><div id="https://www.notion.so/e21c3b21a825459aaf1dd199d94ea549" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">利用bind的特性，可以实现部分</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">柯里化</code></span></span></p></div><h2 id="https://www.notion.so/c85ba6b6400b434883442d9d5017c84d" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/c85ba6b6400b434883442d9d5017c84d"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">new绑定</span></span></h2><div id="https://www.notion.so/b9f3146a6251458eb5fd0956a5fafe67" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">使用new调用函数，会执行下面的操作：</span></span></p></div><ol class="NumberedListWrapper"><li id="https://www.notion.so/fa35d2d748374a11b600171b85252023" class="NumberedList" value="1"><span class="SemanticStringArray"><span class="SemanticString">创建一个全新的对象</span></span></li><li id="https://www.notion.so/c595b81c176a4e1faa942cbad5c523ac" class="NumberedList" value="2"><span class="SemanticStringArray"><span class="SemanticString">这个对象的会被执行原型链的链接（a.__proto__ → A.prototype）</span></span></li><li id="https://www.notion.so/dcf33d4e4a524129b1ff3f1c0b0ef75b" class="NumberedList" value="3"><span class="SemanticStringArray"><span class="SemanticString">这个对象会绑定到函数调用的this</span></span></li><li id="https://www.notion.so/2d996fba117c4981be93eaf139f30f79" class="NumberedList" value="4"><span class="SemanticStringArray"><span class="SemanticString">如果函数没有返回其他对象(如果有就返回这个对象)，那么就自动返回这个对象</span></span></li></ol><h1 id="https://www.notion.so/d46fab1c0d664579b2612d8b1c2f5b2f" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/d46fab1c0d664579b2612d8b1c2f5b2f"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">优先级</span></span></h1><ol class="NumberedListWrapper"><li id="https://www.notion.so/e09784b03f13484a90ab3c20e0ed7720" class="NumberedList" value="1"><span class="SemanticStringArray"><span class="SemanticString">默认保底</span></span></li><li id="https://www.notion.so/9b57832140e74387bd37e2ea4f399c53" class="NumberedList" value="2"><span class="SemanticStringArray"><span class="SemanticString">显式和new &gt; 隐式</span></span></li></ol><div id="https://www.notion.so/563473fe86e0484682728fba3675f59c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">那么显式和new谁更高一点呢？</span></span></p></div><div id="https://www.notion.so/bf508e7363c64cf9beafc21823449e87" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">new的视线使用了硬绑定函数，会判断硬绑定函数是否被new调用，如果是，那么会使用新创建的this替换硬绑定的this</span></span></p></div><div id="https://www.notion.so/985f8784fdef40889ed67e2d4d4ce215" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">所以，</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">new &gt; 硬绑定</code></span></span></p></div><h1 id="https://www.notion.so/7083bbe3523d4f13afe41aa7112c80d4" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/7083bbe3523d4f13afe41aa7112c80d4"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">绑定例外</span></span></h1><h2 id="https://www.notion.so/96ed6388ed1d46d295e21b6c16947d3b" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/96ed6388ed1d46d295e21b6c16947d3b"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">被忽视的this</span></span></h2><div id="https://www.notion.so/c53b26fc9c614650a1f13534635ac45d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">把null、undefined作为this传入call、apply、bind函数的时候，这些值会被忽略进而使用默认规则</span></span></p></div><div id="https://www.notion.so/6a56ae045a17435b9ab106d3514b8b87" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">然而，这样做可能会产生一些意想不到的副作用</span></span></p></div><h3 id="https://www.notion.so/da76b6942f064ddd9de7cca1faf0247e" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/da76b6942f064ddd9de7cca1faf0247e"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">更安全的this</span></span></h3><div id="https://www.notion.so/d8a5e4cabbc249f69f8aab01b8e82552" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">用Object.create(null)代替</span></span></p></div><h2 id="https://www.notion.so/006ad4b5dfca42978d576a1044a1310b" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/006ad4b5dfca42978d576a1044a1310b"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">间接引用</span></span></h2><div id="https://www.notion.so/72a9e5893b184995b3b0e46ae0757c02" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">这种情况下也会使用默认规则</span></span></p></div><h1 id="https://www.notion.so/6f0e50b7382a44baac702140e9a80392" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/6f0e50b7382a44baac702140e9a80392"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">this词法-箭头函数</span></span></h1><div id="https://www.notion.so/5e12f0393af0427fa95bb0da4c7a7925" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">箭头函数不使用以上四条规则，而是</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">根据外层（函数或者全局）作用域来决定this</code></span></span></p></div><pre id="https://www.notion.so/4eb57e8319a44345b97ee8f29b17d6b7" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token parameter">a</span><span class="token punctuation">)</span> <span class="token operator">=></span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>a<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> obj1 <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span>
<span class="token keyword">var</span> obj2 <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span>

<span class="token keyword">var</span> bar <span class="token operator">=</span> <span class="token function">foo</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj1<span class="token punctuation">)</span>
<span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 1</span>
<span class="token function">bar</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj2<span class="token punctuation">)</span> <span class="token comment">// 1</span></span></span></span></code></pre><div id="https://www.notion.so/6decc336149840e6bbd6f36a61bdc656" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">一旦绑定了就不会变</span></span></p></div><h1 id="https://www.notion.so/cd84ebf0a103424a869c69a62c704513" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/cd84ebf0a103424a869c69a62c704513"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">知识补充</span></span></h1><h2 id="https://www.notion.so/ac1181d3150847e3b7e22f0c126e91d9" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/ac1181d3150847e3b7e22f0c126e91d9"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">手写bind，call，apply</span></span></h2><div id="https://www.notion.so/c64cfe41179e4a11904204edf7d6ff15" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">通过手写方式，可以更好的了解原理</span></span></p></div><h3 id="https://www.notion.so/416d99f2362f422db3b0ab9ee5c8fdf6" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/416d99f2362f422db3b0ab9ee5c8fdf6"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">bind</span></span></h3><ol class="NumberedListWrapper"><li id="https://www.notion.so/12a4cedc80ef434f9f6695ebdc9a962d" class="NumberedList" value="1"><span class="SemanticStringArray"><span class="SemanticString">返回的是一个函数</span></span></li><li id="https://www.notion.so/827b051f9b4f43f6a586f59d51d7348e" class="NumberedList" value="2"><span class="SemanticStringArray"><span class="SemanticString">判断是否被构造函数调用，如果是，则使用new调用当前函数</span></span></li><li id="https://www.notion.so/f932bf9db19948e8a481456857dd9af0" class="NumberedList" value="3"><span class="SemanticStringArray"><span class="SemanticString">如果不是，使用call或者apply调用函数</span></span></li></ol><pre id="https://www.notion.so/b11ccfce99a84d948a5f91fddbcc53d5" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">myBind</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">context<span class="token punctuation">,</span> <span class="token operator">...</span>arg1</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">===</span> <span class="token class-name">Fuction</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">TypeError</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">const</span> _this <span class="token operator">=</span> <span class="token keyword">this</span>
	<span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token constant">F</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token keyword">instanceof</span> <span class="token class-name">F</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">_this</span><span class="token punctuation">(</span><span class="token operator">...</span>arg1<span class="token punctuation">,</span> <span class="token operator">...</span>arg2<span class="token punctuation">)</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">return</span> <span class="token function">_this</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> <span class="token operator">...</span>arg1<span class="token punctuation">,</span> <span class="token operator">...</span>arg2<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span></span></span></span></code></pre><h3 id="https://www.notion.so/9b26e9acbc4b4af4bc5acc6beea1b251" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/9b26e9acbc4b4af4bc5acc6beea1b251"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">call</span></span></h3><ol class="NumberedListWrapper"><li id="https://www.notion.so/c81fc3c18d8b4853925d991a4cac7338" class="NumberedList" value="1"><span class="SemanticStringArray"><span class="SemanticString">返回一个结果</span></span></li><li id="https://www.notion.so/502013b00e0e45269b0e7d88aaf8927a" class="NumberedList" value="2"><span class="SemanticStringArray"><span class="SemanticString">判断this是否是函数</span></span></li><li id="https://www.notion.so/64dcecdd781e4c029f84b07d0ade51b7" class="NumberedList" value="3"><span class="SemanticStringArray"><span class="SemanticString">context味可选，默认为window</span></span></li></ol><pre id="https://www.notion.so/5d28b7c2f4244c8db26fd93bff4ebb56" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">myCall</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">context <span class="token operator">=</span> window<span class="token punctuation">,</span> <span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">===</span> <span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token keyword">undefined</span> <span class="token comment">// 用于防止 Function.prototype.myCall() 直接调用</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">const</span> fn <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	context<span class="token punctuation">[</span>fn<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">this</span>
	<span class="token keyword">const</span> result <span class="token operator">=</span> context<span class="token punctuation">[</span>fn<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span>
	<span class="token keyword">delete</span> context<span class="token punctuation">[</span>fn<span class="token punctuation">]</span>
	<span class="token keyword">return</span> result
<span class="token punctuation">}</span></span></span></span></code></pre><h3 id="https://www.notion.so/d9b41da25be443f490fd265124c40330" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/d9b41da25be443f490fd265124c40330"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">apply</span></span></h3><div id="https://www.notion.so/1c349f05536e4c449b8735eba0875ad3" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">同call，只是参数略有不同</span></span></p></div><pre id="https://www.notion.so/b174092327024bb2b7612d3d4b3f0f12" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">myApply</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">context <span class="token operator">=</span> window<span class="token punctuation">,</span> args</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">===</span> <span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token keyword">undefined</span> <span class="token comment">// 用于防止 Function.prototype.myApply() 直接调用</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">const</span> fn <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	context<span class="token punctuation">[</span>fn<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">this</span>
	<span class="token keyword">let</span> result
	<span class="token keyword">if</span> <span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		result <span class="token operator">=</span> context<span class="token punctuation">[</span>fn<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span>
	<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
		result <span class="token operator">=</span> context<span class="token punctuation">[</span>fn<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span> 
	<span class="token keyword">delete</span> context<span class="token punctuation">[</span>fn<span class="token punctuation">]</span>
	<span class="token keyword">return</span> result
<span class="token punctuation">}</span></span></span></span></code></pre><h1 id="https://www.notion.so/9f44fedeb0fd4be3ba1e220304dc6452" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/9f44fedeb0fd4be3ba1e220304dc6452"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">TODO</span></span></h1><ol class="NumberedListWrapper"><li id="https://www.notion.so/e614183e27d44d1e8a7a0a0306f9978d" class="NumberedList" value="1"><span class="SemanticStringArray"><span class="SemanticString">react中，不用bind的原因</span></span></li></ol><div id="https://www.notion.so/a82bf71da8f24ea8be595cddc526fef2" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div></article>
  <footer class="Footer">
  <div>&copy; Zhao’s Blog 2022</div>
  <div>&centerdot;</div>
  <div>Powered by <a href="https://github.com/dragonman225/notablog" target="_blank"
      rel="noopener noreferrer">Notablog</a>.
  </div>
</footer>
</body>

</html>