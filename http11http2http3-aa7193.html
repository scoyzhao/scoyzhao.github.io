<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- iOS Safari -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<!-- Chrome, Firefox OS and Opera Status Bar Color -->
<meta name="theme-color" content="#FFFFFF">
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css">
<link rel="stylesheet" type="text/css"
  href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.19.0/themes/prism.min.css">
<link rel="stylesheet" type="text/css" href="css/SourceSansPro.css">
<link rel="stylesheet" type="text/css" href="css/theme.css">
<link rel="stylesheet" type="text/css" href="css/notablog.css">
<!-- Favicon -->

  <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;📖&lt;/text&gt;&lt;/svg&gt;">

<style>
  :root {
    font-size: 20px;
  }
</style>
  <title>http1.1、http2、http3和性能&nbsp;|&nbsp;Zhao’s Blog</title>
  <meta property="og:type" content="blog">
  <meta property="og:title" content="http1.1、http2、http3和性能">
  
    <meta name="description" content="http的一些知识点总结">
    <meta property="og:description" content="http的一些知识点总结">
  
  
    <meta property="og:image" content="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;😀&lt;/text&gt;&lt;/svg&gt;">
  
  <style>
    .DateTagBar {
      margin-top: 1.0rem;
    }
  </style>
</head>

<body>
  <nav class="Navbar">
  <a href="index.html">
    <div class="Navbar__Btn">
      
        <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;📖&lt;/text&gt;&lt;/svg&gt;"></span>&nbsp;
      
      <span>Home</span>
    </div>
  </a>
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <span class="Navbar__Delim">&centerdot;</span>
      <a href="about.html">
        <div class="Navbar__Btn">
          
            <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;😀&lt;/text&gt;&lt;/svg&gt;"></span>&nbsp;
          
          <span>About</span>
        </div>
      </a>
    
  
</nav>
  <header class="Header">
    
    <div class="Header__Spacer Header__Spacer--NoCover">
    </div>
    
      <div class="Header__Icon">
        <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;😀&lt;/text&gt;&lt;/svg&gt;"></span>
      </div>
    
    <h1 class="Header__Title">http1.1、http2、http3和性能</h1>
    
      <div class="DateTagBar">
        
          <span class="DateTagBar__Item DateTagBar__Date">Posted on Sun, Mar 26, 2023</span>
        
        
          <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--green">
            <a href="tag/Front End.html">Front End</a>
          </span>
        
          <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--brown">
            <a href="tag/知识扩展.html">知识扩展</a>
          </span>
        
      </div>
    
  </header>
  <article id="https://www.notion.so/aa71936523f74a048b68a191d0eb80b6" class="PageRoot PageRoot--FullWidth"><ul id="https://www.notion.so/806b74cd26e4457c8d802332105771ec" class="ColorfulBlock ColorfulBlock--ColorGray TableOfContents"><li class="TableOfContents__Item"><a href="#https://www.notion.so/f1108e3177c240b59de197c622b4a5b9"><div style="margin-left:0px"><span class="SemanticStringArray"><span class="SemanticString">http1.1</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/5eaff0a979d94946babf0497d0cd6e3b"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">优化点</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/e28f6786233f4bd9a0b29d652986b62a"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString">缓存处理</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/87c3d30e5ec7427385ecbb7fd210741d"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString"> 带宽优化</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/aa3e117b733a42b39daee10f6866eec8"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString">错误通知的管理</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/8835873e65a84da0b96ce9cd66410216"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString">Host头处理</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/c733985a42ec4eb88ea38a0cdb76dce2"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString">*长连接</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/7bb156b584af4ba9a9d9fe622f782eb8"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">小结</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/6d6cb758e70d4283bd00a02bfee393d3"><div style="margin-left:0px"><span class="SemanticStringArray"><span class="SemanticString">http2</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/1a4dbf52ad8743aabce688f59b73ee78"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">连接复用</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/bb25adc3859841b888c60104026b0970"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString">队头阻塞</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/4b23a08d1c79455c8d67d65d72e21d33"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString">什么情况下不能连接复用</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/76a471b31fe24d0dbcde60f7f44cd790"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">头部压缩</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/54d7cf4e70e54d37ba18015e0299e62e"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">为什么没有广泛使用Server Push</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/1fa1b7f42a214049a857944edafa3080"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString">资源文件加载</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/465b6011bc0447d49dee81ee35e388e1"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString">Early Hints</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/32c4a474cbcd43959bc327cebacc8cbf"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">HTTP3</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/2aacf173997e455d89d66e0dd4485094"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString">HTTP2存在的问题</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/6621b3927e2d4c66869a3362fc70167d"><div style="margin-left:72px"><span class="SemanticStringArray"><span class="SemanticString">TCP对头阻塞</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/bbc2e2ea6d40484bb9b977ebaaae60c0"><div style="margin-left:72px"><span class="SemanticStringArray"><span class="SemanticString">TCP握手时长</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/3c9214a7bce841e1b543fddf80e505d9"><div style="margin-left:72px"><span class="SemanticStringArray"><span class="SemanticString">移动网络切换成本</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/5177306dfa1f47b5abd5422812accc07"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString">HTTP3如何解决问题</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/2741a4eb7f2e4d5b8d301d03e6ebbe64"><div style="margin-left:72px"><span class="SemanticStringArray"><span class="SemanticString">升级协议是否可行</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/6da9708da6734a3b860481668c490c97"><div style="margin-left:72px"><span class="SemanticStringArray"><span class="SemanticString">QUIC over UDP</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/569b64d403414b9697272e00883a1a01"><div style="margin-left:72px"><span class="SemanticStringArray"><span class="SemanticString">队头阻塞问题</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/42c2ee7044eb45bf91475621344f428d"><div style="margin-left:72px"><span class="SemanticStringArray"><span class="SemanticString">握手耗时</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/4a511bb5ab6d4559a063e6ef882bd467"><div style="margin-left:72px"><span class="SemanticStringArray"><span class="SemanticString">移动场景优化</span></span></div></a></li></ul><div id="https://www.notion.so/2fc0ed40205e4313a21c724557a715c0" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">HTTP协议（超文本传输协议）是一种网络通信协议，它允许将超文本标记语言(HTML)文档从Web服务器传送到客户端的浏览器。</span></span></p></div><h1 id="https://www.notion.so/f1108e3177c240b59de197c622b4a5b9" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/f1108e3177c240b59de197c622b4a5b9"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">http1.1</span></span></h1><div id="https://www.notion.so/8e53e1b8927141c29ebbc5ecb918fb28" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">http最早在1996年使用，请求都比较简单，而http1.1在此基础上做了优化，有以下几个方面</span></span></p></div><h2 id="https://www.notion.so/5eaff0a979d94946babf0497d0cd6e3b" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/5eaff0a979d94946babf0497d0cd6e3b"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">优化点</span></span></h2><h3 id="https://www.notion.so/e28f6786233f4bd9a0b29d652986b62a" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/e28f6786233f4bd9a0b29d652986b62a"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">缓存处理</span></span></h3><div id="https://www.notion.so/9995080fef4948b89f3dd827e8735fc2" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">在HTTP1.0中主要使用header里的If-Modified-Since,Expires来做为缓存判断的标准。HTTP1.1则引入了更多的缓存控制策略例如Entity tag，If-Unmodified-Since, If-Match, If-None-Match等更多可供选择的缓存头来控制缓存策略</span></span></p></div><h3 id="https://www.notion.so/87c3d30e5ec7427385ecbb7fd210741d" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/87c3d30e5ec7427385ecbb7fd210741d"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"> 带宽优化</span></span></h3><div id="https://www.notion.so/7c5474a061734306adf6184b772eec31" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">带宽优化及网络连接的使用，HTTP1.0中，存在一些浪费带宽的现象，例如客户端只是需要某个对象的一部分，而服务器却将整个对象送过来了，并且不支持断点续传功能，HTTP1.1则在请求头引入了range头域，它允许只请求资源的某个部分，即返回码是206（Partial Content），这样就方便了开发者自由的选择以便于充分利用带宽和连接</span></span></p></div><h3 id="https://www.notion.so/aa3e117b733a42b39daee10f6866eec8" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/aa3e117b733a42b39daee10f6866eec8"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">错误通知的管理</span></span></h3><div id="https://www.notion.so/b0e23d96f53948f7a43ad0119933031e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">在HTTP1.1中新增了24个错误状态响应码，如409（Conflict）表示请求的资源与资源的当前状态发生冲突；410（Gone）表示服务器上的某个资源被永久性的删除。</span></span></p></div><h3 id="https://www.notion.so/8835873e65a84da0b96ce9cd66410216" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/8835873e65a84da0b96ce9cd66410216"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Host头处理</span></span></h3><div id="https://www.notion.so/75484ca77f1e4cf7bcdf3b0c2c133231" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">在HTTP1.0中认为每台服务器都绑定一个唯一的IP地址，因此，请求消息中的URL并没有传递主机名（hostname）。但随着虚拟主机技术的发展，在一台物理服务器上可以存在多个虚拟主机（Multi-homed Web Servers），并且它们共享一个IP地址。HTTP1.1的请求消息和响应消息都应支持Host头域，且请求消息中如果没有Host头域会报告一个错误（400 Bad Request）。</span></span></p></div><h3 id="https://www.notion.so/c733985a42ec4eb88ea38a0cdb76dce2" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/c733985a42ec4eb88ea38a0cdb76dce2"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">*长连接</span></span></h3><div id="https://www.notion.so/867ce2a14c0f4fe8b06bd508be211011" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">HTTP 1.1支持长连接（PersistentConnection）和请求的流水线（Pipelining）处理，在一个TCP连接上可以传送多个HTTP请求和响应，减少了建立和关闭连接的消耗和延迟，在HTTP1.1中默认开启Connection： keep-alive，一定程度上弥补了HTTP1.0每次请求都要创建连接的缺点。客户端可以控制保持连接的时间，一般不会太长。</span></span></p></div><h2 id="https://www.notion.so/7bb156b584af4ba9a9d9fe622f782eb8" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/7bb156b584af4ba9a9d9fe622f782eb8"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">小结</span></span></h2><div id="https://www.notion.so/9eefd43a3ac243a98db41c43e9d193e2" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">以上都是优化点，关注的比较多的可能是长连接，因为在后续的优化还有涉及。</span></span></p></div><h1 id="https://www.notion.so/6d6cb758e70d4283bd00a02bfee393d3" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/6d6cb758e70d4283bd00a02bfee393d3"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">http2</span></span></h1><div id="https://www.notion.so/204ca8ce1b0846abaaca2dff4535840e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">http2而言，提高性能的主要手段或者说特点有三个：</span></span></p></div><ol class="NumberedListWrapper"><li id="https://www.notion.so/0ab90e9a146c4a8b94864383846fa1dc" class="NumberedList" value="1"><span class="SemanticStringArray"><span class="SemanticString">连接复用</span></span></li><li id="https://www.notion.so/50275d3ab5df4776b98f397465765b0a" class="NumberedList" value="2"><span class="SemanticStringArray"><span class="SemanticString">头部压缩</span></span></li><li id="https://www.notion.so/a58ee1ae12f94dd08b7403e893089abf" class="NumberedList" value="3"><span class="SemanticStringArray"><span class="SemanticString">Server Push</span></span></li></ol><div id="https://www.notion.so/a1521704bcd04f759d9e9e60ea387641" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">其中，前两个已经大规模使用，而Server Push特性由于一些原因并没有大规模使用</span></span></p></div><h2 id="https://www.notion.so/1a4dbf52ad8743aabce688f59b73ee78" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/1a4dbf52ad8743aabce688f59b73ee78"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">连接复用</span></span></h2><div id="https://www.notion.so/7e0d6fb9af7c4cc8a1158f2574f7bebe" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">HTTP1的请求，每一次都需要一个TCP连接，对于多个请求来说是一种浪费。HTTP1.1虽然有keep-alive属性，但是他根本上其实是复用TCP连接</span></span></p></div><h3 id="https://www.notion.so/bb25adc3859841b888c60104026b0970" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/bb25adc3859841b888c60104026b0970"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">队头阻塞</span></span></h3><div id="https://www.notion.so/651abd4edfde4feda8483ca045afd30b" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">http1.1复用TCP连接的时候，多个请求需要排队进行，第二个请求需要等第一个响应之后才能发送，即使二者没有依赖关系。为了实现并行请求，客户端可以建立多个TCP连接来发送多个HTTP请求，但是TCP连接和维护需要成本，一般浏览器以域名维度限制TCP连接的并发数，一般是6.</span></span></p></div><div id="https://www.notion.so/0701c1b42be048cd962143ee66cc9523" class="ColorfulBlock ColorfulBlock--BgGray Callout"><div class="Callout__Icon"><div class="Icon">💡</div></div><p class="Callout__Content"><span class="SemanticStringArray"><span class="SemanticString">这就有一种优化方式：把多个请求拆分到不同的域名</span></span></p></div><div id="https://www.notion.so/30271fa5a07f4ab397534f063db9e79e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">http2提出了更根本的解决方案：</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">让HTTP在单个TCP连接内可以发送多个请求，并且可以乱序返回</code></span><span class="SemanticString"> </span></span></p></div><div id="https://www.notion.so/a84104a54daa488da67b69178f08e32c" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fe1ad65fb-cc2f-4bee-9b57-625b2d6286bb%2FUntitled.jpeg?width=2765&amp;table=block&amp;id=a84104a5-4daa-488d-a67b-69178f08e32c"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fe1ad65fb-cc2f-4bee-9b57-625b2d6286bb%2FUntitled.jpeg?width=2765&amp;table=block&amp;id=a84104a5-4daa-488d-a67b-69178f08e32c" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><h3 id="https://www.notion.so/4b23a08d1c79455c8d67d65d72e21d33" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/4b23a08d1c79455c8d67d65d72e21d33"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">什么情况下不能连接复用</span></span></h3><ol class="NumberedListWrapper"><li id="https://www.notion.so/ffe46e41b58746fb803d551e5ccc7866" class="NumberedList" value="1"><span class="SemanticStringArray"><span class="SemanticString">crossorigin</span></span></li></ol><div id="https://www.notion.so/f0b40d73bea44b17add001de1c609aee" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">在实践中，有些HTTP请求并不像预期那样复用同一个TCP连接，对其JavaScript代码特点可以发现，它的script标签的差异在于标注了</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">crossorigin</code></span></span></p></div><div id="https://www.notion.so/89b428b5079b4b6fbe914ed45d702f6e" class="ColorfulBlock ColorfulBlock--BgGray Callout"><div class="Callout__Icon"><div class="Icon">💡</div></div><p class="Callout__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">crossorigin</strong></code></span><span class="SemanticString">属性在 </span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/audio"><code class="SemanticString__Fragment SemanticString__Fragment--Code">&lt;audio&gt;</code></a></span><span class="SemanticString">、</span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/img"><code class="SemanticString__Fragment SemanticString__Fragment--Code">&lt;img&gt;</code></a></span><span class="SemanticString">、</span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/link"><code class="SemanticString__Fragment SemanticString__Fragment--Code">&lt;link&gt;</code></a></span><span class="SemanticString">、</span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/script"><code class="SemanticString__Fragment SemanticString__Fragment--Code">&lt;script&gt;</code></a></span><span class="SemanticString">和 </span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/video"><code class="SemanticString__Fragment SemanticString__Fragment--Code">&lt;video&gt;</code></a></span><span class="SemanticString">元素中有效，它们提供对 </span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/CORS">CORS</a></span><span class="SemanticString">的支持，定义该元素如何处理跨源请求，从而实现对该元素获取数据的 CORS 请求的配置。根据元素的不同，该属性可以是一个 CORS 设置属性。
</span></span><div id="https://www.notion.so/6fa0ff301fb04d7cab4ef3fea7ca032b" class="ColorfulBlock ColorfulBlock--BgGray Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">anonymous</code></span></span></p></div><div id="https://www.notion.so/0397cee80d2d4a40833153803d8a5914" class="ColorfulBlock ColorfulBlock--BgGray Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">请求使用了 CORS 标头，且证书标志被设置为 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">&#x27;same-origin&#x27;</code></span><span class="SemanticString">。没有通过 cookies、客户端 SSL 证书或 HTTP 认证交换</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">用户凭据</strong></span><span class="SemanticString">，除非目的地是同一来源。</span></span></p></div><div id="https://www.notion.so/435a62c9788344f6b36094e8eaff274d" class="ColorfulBlock ColorfulBlock--BgGray Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">use-credentials</code></span></span></p></div><div id="https://www.notion.so/0ffeeca6fd084d618d4b38197392f2d1" class="ColorfulBlock ColorfulBlock--BgGray Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">请求使用了 CORS 标头，且证书标志被设置为 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">&#x27;include&#x27;</code></span><span class="SemanticString">。总是包含</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">用户凭据</strong></span><span class="SemanticString">。</span></span></p></div><div id="https://www.notion.so/883f2e47298a484d84ae8a7b9309255a" class="ColorfulBlock ColorfulBlock--BgGray Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">&quot;&quot;</code></span></span></p></div><div id="https://www.notion.so/102f25711a514834acdd6aa2676d93ea" class="ColorfulBlock ColorfulBlock--BgGray Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">将属性名称设置为空值，如 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">crossorigin</code></span><span class="SemanticString"> 或 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">crossorigin=&quot;&quot;</code></span><span class="SemanticString">，与设置为 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">anonymous</code></span><span class="SemanticString"> 的效果一样。</span></span></p></div><div id="https://www.notion.so/9e7c11e8d3ef463796d1ebc2da898440" class="ColorfulBlock ColorfulBlock--BgGray Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">不合法的关键字或空字符串会视为 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">anonymous</code></span><span class="SemanticString"> 关键字。</span></span></p></div><div id="https://www.notion.so/e8cf1981c2634aa5a73f51f81320ded5" class="ColorfulBlock ColorfulBlock--BgGray Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/e9d54ac8b5234b4aa165fe979a79891c" class="ColorfulBlock ColorfulBlock--BgGray Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">默认情况下（即未指定该属性时），CORS 根本不会使用。

一般来说，</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">crossorigin</code></span><span class="SemanticString">常见的作用是让前端的错误手机系统可以跨域手机JavaScript脚本产生的错误栈</span></span></p></div></p></div><div id="https://www.notion.so/d1e48da9f1c54445b40d7c931fdf40bf" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">根据Fetch的标准，一个连接由key、origin和credentials组成，而</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">crossorigin的默认值crossorigin=anonymous代表credentials为false</code></span></span></p></div><div id="https://www.notion.so/5c084df1d489451684bf772575e1bd87" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">对于script来说，默认不加crossorigin的情况下是非CORS请求，是携带credentials，这也是JSONP会携带客户端Cookie的原因</span></span></p></div><div id="https://www.notion.so/453aa030d88b4d7bacdfe232252e1227" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">这会导致页面上携带和不携带crossorigin的script标签使用不同的连接。</span></span></p></div><div id="https://www.notion.so/4075a1805bdb469997bcc6af30216895" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><ol class="NumberedListWrapper"><li id="https://www.notion.so/a46fb93f26774d6eabbffb067907d6f6" class="NumberedList" value="1"><span class="SemanticStringArray"><span class="SemanticString">SSL证书等</span></span></li></ol><div id="https://www.notion.so/d7915962d7394fe1921449f7932cfa7f" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">HTTP2的多路复用，复用的是TCP连接，而一个TCP连接是由Client IP、Host IP、Client Port和Host Port四元组确认的，所以即使</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">不同域名，但是是一个Host IP，也可以复用</code></span></span></p></div><div id="https://www.notion.so/f197ac5a3e3a489b983d50dd2605165c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">如果多个连接SSL证书不是同一个，那么也无法复用连接</span></span></p></div><h2 id="https://www.notion.so/76a471b31fe24d0dbcde60f7f44cd790" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/76a471b31fe24d0dbcde60f7f44cd790"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">头部压缩</span></span></h2><div id="https://www.notion.so/9a98d32efb16438baececa0f71db1e23" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">头部体积比较大的主要是Cookie，HTTP2使用了HPACK算法压缩头部体积</span></span></p></div><h2 id="https://www.notion.so/54d7cf4e70e54d37ba18015e0299e62e" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/54d7cf4e70e54d37ba18015e0299e62e"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">为什么没有广泛使用Server Push</span></span></h2><div id="https://www.notion.so/0321f3a2bd0d4c1a87b759f23cd53e57" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Server Push让服务器吧资源文件和页面一起返回给客户端，以此来提高性能。遇到的问题：</span></span></p></div><h3 id="https://www.notion.so/1fa1b7f42a214049a857944edafa3080" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/1fa1b7f42a214049a857944edafa3080"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">资源文件加载</span></span></h3><div id="https://www.notion.so/8f16a397696a4e1badb63de7f1483ee6" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">html页面里有script加载js，这个时候需要加载完html才能请求js</span></span></p></div><div id="https://www.notion.so/ef094861f17643cb828171875df3ea66" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">解决办法有几个：</span></span></p></div><ol class="NumberedListWrapper"><li id="https://www.notion.so/aef922c6b3064c4da1d556aa97e72119" class="NumberedList" value="1"><span class="SemanticStringArray"><span class="SemanticString">preload：这个link标签，告知浏览器提前加载。但是preload不会提前执行内容，等html加载完才会起作用，所以需要发起两个请求，节约HTML下载和后续解析消耗的时间</span></span></li><li id="https://www.notion.so/ffd1c5b8cd0a46ecb1822c211f268148" class="NumberedList" value="2"><span class="SemanticStringArray"><span class="SemanticString">内联：把js内容写在html中，但是这样就无法缓存了</span></span></li><li id="https://www.notion.so/f15b44b08d42491eaf8bb33f703bea0f" class="NumberedList" value="3"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">Server Push</code></span></span></li></ol><div id="https://www.notion.so/b67544099d5d40cdbd956044876b46d1" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">server收到客户端HTML请求的时候，主动把接下来需要使用的资源推给客户端。但是它同样无法有效的和本地缓存互相利用</span></span></p></div><div id="https://www.notion.so/96ae9adc7e2b498a81b7bd2c1a0d8e32" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">并且因为这个特点，无法使用第三方CDN的特点，为了尽快发送而放弃CDN在静态资源托管上的优势，往往是得不偿失的</span></span></p></div><h3 id="https://www.notion.so/465b6011bc0447d49dee81ee35e388e1" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/465b6011bc0447d49dee81ee35e388e1"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Early Hints</span></span></h3><div id="https://www.notion.so/4cdf17cf2863439faba8a150a2c7b8d7" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">一个标准的草安，允许服务器在HTML相应还没准备好的情况下先响应一个103，告知浏览器从什么地方提前加载内容</span></span></p></div><div id="https://www.notion.so/337eb4dc70d3488cb734d240809ad12d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">这样，客户端可以自行判断本地是否有缓存，相比preload，不需要等待html完全准备完毕</span></span></p></div><h1 id="https://www.notion.so/32c4a474cbcd43959bc327cebacc8cbf" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/32c4a474cbcd43959bc327cebacc8cbf"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">HTTP3</span></span></h1><div id="https://www.notion.so/2549121135fe4b6589fe0cc7a63e6920" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">从上面来看，HTTP2已经解决了很多问题，那么为什么还需要引入HTTP3呢？</span></span></p></div><h2 id="https://www.notion.so/2aacf173997e455d89d66e0dd4485094" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/2aacf173997e455d89d66e0dd4485094"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">HTTP2存在的问题</span></span></h2><div id="https://www.notion.so/0758d0f7182d4114981601b40783a045" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">无论是http1还是http2，都是基于TCP协议，这意味着TCP协议带来的问题无法解决</span></span></p></div><h3 id="https://www.notion.so/6621b3927e2d4c66869a3362fc70167d" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/6621b3927e2d4c66869a3362fc70167d"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">TCP对头阻塞</span></span></h3><div id="https://www.notion.so/4c7e809b8afe4b5c9b33bb91584b6cfc" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fe66c12d5-8925-4751-9670-cf6d94f98fd3%2FUntitled.jpeg?width=2989&amp;table=block&amp;id=4c7e809b-8afe-4b5c-9b33-bb91584b6cfc"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fe66c12d5-8925-4751-9670-cf6d94f98fd3%2FUntitled.jpeg?width=2989&amp;table=block&amp;id=4c7e809b-8afe-4b5c-9b33-bb91584b6cfc" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><h3 id="https://www.notion.so/bbc2e2ea6d40484bb9b977ebaaae60c0" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/bbc2e2ea6d40484bb9b977ebaaae60c0"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">TCP握手时长</span></span></h3><h3 id="https://www.notion.so/3c9214a7bce841e1b543fddf80e505d9" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/3c9214a7bce841e1b543fddf80e505d9"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">移动网络切换成本</span></span></h3><div id="https://www.notion.so/34a8ecaa15f347008369e942a38559a9" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">随着移动用户越来越多，网络环境常常发生变化，那么客户端IP和PORT就会发生变化，这种情况下就会连接失败，需要重新建立连接</span></span></p></div><h2 id="https://www.notion.so/5177306dfa1f47b5abd5422812accc07" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/5177306dfa1f47b5abd5422812accc07"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">HTTP3如何解决问题</span></span></h2><div id="https://www.notion.so/09ca9c899f8249babb986130ded20c63" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">从上面可以看到，http2的问题不是协议本身，而是TCP的问题，那么主要就是要解决它</span></span></p></div><h3 id="https://www.notion.so/2741a4eb7f2e4d5b8d301d03e6ebbe64" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/2741a4eb7f2e4d5b8d301d03e6ebbe64"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">升级协议是否可行</span></span></h3><div id="https://www.notion.so/9665d7904e344ef3bcbed03185acd79b" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">协议传输需要经过很多设备，如果TCP协议有升级，这些设备都需要升级，操作系统需要部署周期</span></span></p></div><h3 id="https://www.notion.so/6da9708da6734a3b860481668c490c97" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/6da9708da6734a3b860481668c490c97"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">QUIC over UDP</span></span></h3><div id="https://www.notion.so/c8d0c26b8a5b4425b58898f29e69889c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">升级不可行，创造新的协议也有一样的问题，剩下的方案就是在UDP上定制协议。</span></span></p></div><div id="https://www.notion.so/5df49ee3ac58440985d3f9d252fcb5ea" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">QUIC（Quick UDP Internet Connection）：快速UDP互联网连接。TCP被设计为一个管道，并不理解传输的内容，这也是TLS必须在TCP连接的基础上再进行额外的握手，以及HTTP2多路复用无法在丢包的情况下完成乱序响应的原因。而QUIC试图去</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">理解传输的内容</code></span><span class="SemanticString">，因此把</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">协商密钥</code></span><span class="SemanticString">作为协议的一部分</span></span></p></div><h3 id="https://www.notion.so/569b64d403414b9697272e00883a1a01" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/569b64d403414b9697272e00883a1a01"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">队头阻塞问题</span></span></h3><div id="https://www.notion.so/27da6550949f4f458f17c2a47aceb545" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">QUIC提供了类似HTTP2多路复用中的数据流概念，在单个数据流中保证有序交付，而多个数据流之间互不影响</span></span></p></div><h3 id="https://www.notion.so/42c2ee7044eb45bf91475621344f428d" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/42c2ee7044eb45bf91475621344f428d"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">握手耗时</span></span></h3><div id="https://www.notion.so/02b25e8d554e487680512683dc0097d5" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">QUIC摆脱了TCP的限制，可以把我手和交换密钥房子啊一次完成，从而实现了1个RTT握手</span></span></p></div><h3 id="https://www.notion.so/4a511bb5ab6d4559a063e6ef882bd467" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/4a511bb5ab6d4559a063e6ef882bd467"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">移动场景优化</span></span></h3><div id="https://www.notion.so/b6b978054d964d498bb52a7f8334b436" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">QUIC针对移动场景常常出现的网络环境变化的情况，支持迁移，也就是当客户端网络IP地址改变以后，也能保持连接不间断</span></span></p></div></article>
  <footer class="Footer">
  <div>&copy; Zhao’s Blog 2022</div>
  <div>&centerdot;</div>
  <div>Powered by <a href="https://github.com/dragonman225/notablog" target="_blank"
      rel="noopener noreferrer">Notablog</a>.
  </div>
</footer>
</body>

</html>