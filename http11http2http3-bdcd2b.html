<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- iOS Safari -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<!-- Chrome, Firefox OS and Opera Status Bar Color -->
<meta name="theme-color" content="#FFFFFF">
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css">
<link rel="stylesheet" type="text/css"
  href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.19.0/themes/prism.min.css">
<link rel="stylesheet" type="text/css" href="css/SourceSansPro.css">
<link rel="stylesheet" type="text/css" href="css/theme.css">
<link rel="stylesheet" type="text/css" href="css/notablog.css">
<!-- Favicon -->

  <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;📖&lt;/text&gt;&lt;/svg&gt;">

<style>
  :root {
    font-size: 20px;
  }
</style>
  <title>http1.1、http2、http3和性能&nbsp;|&nbsp;Zhao’s Blog</title>
  <meta property="og:type" content="blog">
  <meta property="og:title" content="http1.1、http2、http3和性能">
  
    <meta name="description" content="http的一些知识点总结">
    <meta property="og:description" content="http的一些知识点总结">
  
  
    <meta property="og:image" content="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;😀&lt;/text&gt;&lt;/svg&gt;">
  
  <style>
    .DateTagBar {
      margin-top: 1.0rem;
    }
  </style>
</head>

<body>
  <nav class="Navbar">
  <a href="index.html">
    <div class="Navbar__Btn">
      
        <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;📖&lt;/text&gt;&lt;/svg&gt;"></span>&nbsp;
      
      <span>Home</span>
    </div>
  </a>
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <span class="Navbar__Delim">&centerdot;</span>
      <a href="about.html">
        <div class="Navbar__Btn">
          
            <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;😀&lt;/text&gt;&lt;/svg&gt;"></span>&nbsp;
          
          <span>About</span>
        </div>
      </a>
    
  
</nav>
  <header class="Header">
    
    <div class="Header__Spacer Header__Spacer--NoCover">
    </div>
    
      <div class="Header__Icon">
        <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;😀&lt;/text&gt;&lt;/svg&gt;"></span>
      </div>
    
    <h1 class="Header__Title">http1.1、http2、http3和性能</h1>
    
      <div class="DateTagBar">
        
          <span class="DateTagBar__Item DateTagBar__Date">Posted on Sun, Mar 26, 2023</span>
        
        
          <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--green">
            <a href="tag/Front End.html">Front End</a>
          </span>
        
          <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--brown">
            <a href="tag/知识扩展.html">知识扩展</a>
          </span>
        
      </div>
    
  </header>
  <article id="https://www.notion.so/bdcd2bcd0f5d4c38bbf59f03173df981" class="PageRoot PageRoot--FullWidth"><ul id="https://www.notion.so/6155ee22fff94076a2bb3dbb0a9f89df" class="ColorfulBlock ColorfulBlock--ColorGray TableOfContents"><li class="TableOfContents__Item"><a href="#https://www.notion.so/d9357c092b7c450fb9043ba5fca49732"><div style="margin-left:0px"><span class="SemanticStringArray"><span class="SemanticString">http1.1</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/2daa6e2945f445549b92ed9d24ad37f5"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">优化点</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/21b7aeef4427482ab4859ff2266fe657"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString">缓存处理</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/ae26dd0b6b334df096e1e7c94d5a2ebb"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString"> 带宽优化</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/39f1f24a4554438083c42ac933c14e18"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString">错误通知的管理</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/ebcb235d64b94e7ba163cf6dc348d96c"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString">Host头处理</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/2301060da6d249ffb96d351f9b579a9b"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString">*长连接</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/69929cff58e541a1b6ca6e8911217ad2"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">小结</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/aea34c24cebe4979992624f136928162"><div style="margin-left:0px"><span class="SemanticStringArray"><span class="SemanticString">http2</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/7332a54ddc0d4c2d9440c2b43c917347"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">连接复用</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/ec31638bcb814fcc80a233d9ff334a65"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString">队头阻塞</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/8c32b4148264444a806e7652c8281a9d"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString">什么情况下不能连接复用</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/4c34f1e93a37483dae7391580114991d"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">头部压缩</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/ce0933585f6d48bdb438e729200aa8b0"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">为什么没有广泛使用Server Push</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/00907863d6324c478b309f959a7563e5"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString">资源文件加载</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/e18c9d6753bf426fb9e41bdbe34c9ad8"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString">Early Hints</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/a5bac1cab7814bba9da635151d1781b1"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">HTTP3</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/44f946cae5054bc8995886ce06478c49"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString">HTTP2存在的问题</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/3f14f2dce841452496a5e9a0acd50b20"><div style="margin-left:72px"><span class="SemanticStringArray"><span class="SemanticString">TCP对头阻塞</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/a19b5d85f63c4efc9580d4a6b3cf4231"><div style="margin-left:72px"><span class="SemanticStringArray"><span class="SemanticString">TCP握手时长</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/f003daae31ad4c5ea27ac988584333cb"><div style="margin-left:72px"><span class="SemanticStringArray"><span class="SemanticString">移动网络切换成本</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/06944d1c6b654d2f9b40fcd73dcb6536"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString">HTTP3如何解决问题</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/466212ba870049448f35638bd874d1b1"><div style="margin-left:72px"><span class="SemanticStringArray"><span class="SemanticString">升级协议是否可行</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/e044e1bc83744ba69e219415f7569354"><div style="margin-left:72px"><span class="SemanticStringArray"><span class="SemanticString">QUIC over UDP</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/2d2586b834204b60aad1508494eb4865"><div style="margin-left:72px"><span class="SemanticStringArray"><span class="SemanticString">队头阻塞问题</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/c07ddaf83cef483e9392d6aaf584cf94"><div style="margin-left:72px"><span class="SemanticStringArray"><span class="SemanticString">握手耗时</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/1f31bbe305104f1389d8f489be9f9421"><div style="margin-left:72px"><span class="SemanticStringArray"><span class="SemanticString">移动场景优化</span></span></div></a></li></ul><div id="https://www.notion.so/b7c40c8d3eec47e5b17f91614c2097cb" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">HTTP协议（超文本传输协议）是一种网络通信协议，它允许将超文本标记语言(HTML)文档从Web服务器传送到客户端的浏览器。</span></span></p></div><h1 id="https://www.notion.so/d9357c092b7c450fb9043ba5fca49732" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/d9357c092b7c450fb9043ba5fca49732"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">http1.1</span></span></h1><div id="https://www.notion.so/6051f6492a57448899170608c1f2a1b7" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">http最早在1996年使用，请求都比较简单，而http1.1在此基础上做了优化，有以下几个方面</span></span></p></div><h2 id="https://www.notion.so/2daa6e2945f445549b92ed9d24ad37f5" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/2daa6e2945f445549b92ed9d24ad37f5"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">优化点</span></span></h2><h3 id="https://www.notion.so/21b7aeef4427482ab4859ff2266fe657" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/21b7aeef4427482ab4859ff2266fe657"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">缓存处理</span></span></h3><div id="https://www.notion.so/b5c97d3d490742b190b854fbb2ce3f53" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">在HTTP1.0中主要使用header里的If-Modified-Since,Expires来做为缓存判断的标准。HTTP1.1则引入了更多的缓存控制策略例如Entity tag，If-Unmodified-Since, If-Match, If-None-Match等更多可供选择的缓存头来控制缓存策略</span></span></p></div><h3 id="https://www.notion.so/ae26dd0b6b334df096e1e7c94d5a2ebb" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/ae26dd0b6b334df096e1e7c94d5a2ebb"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"> 带宽优化</span></span></h3><div id="https://www.notion.so/76bfe04fe77e43899be44d43444e8533" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">带宽优化及网络连接的使用，HTTP1.0中，存在一些浪费带宽的现象，例如客户端只是需要某个对象的一部分，而服务器却将整个对象送过来了，并且不支持断点续传功能，HTTP1.1则在请求头引入了range头域，它允许只请求资源的某个部分，即返回码是206（Partial Content），这样就方便了开发者自由的选择以便于充分利用带宽和连接</span></span></p></div><h3 id="https://www.notion.so/39f1f24a4554438083c42ac933c14e18" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/39f1f24a4554438083c42ac933c14e18"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">错误通知的管理</span></span></h3><div id="https://www.notion.so/1e8abd518ad14f6da213fa916be3148c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">在HTTP1.1中新增了24个错误状态响应码，如409（Conflict）表示请求的资源与资源的当前状态发生冲突；410（Gone）表示服务器上的某个资源被永久性的删除。</span></span></p></div><h3 id="https://www.notion.so/ebcb235d64b94e7ba163cf6dc348d96c" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/ebcb235d64b94e7ba163cf6dc348d96c"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Host头处理</span></span></h3><div id="https://www.notion.so/41207dffb2af4837bced5c1939dd83e2" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">在HTTP1.0中认为每台服务器都绑定一个唯一的IP地址，因此，请求消息中的URL并没有传递主机名（hostname）。但随着虚拟主机技术的发展，在一台物理服务器上可以存在多个虚拟主机（Multi-homed Web Servers），并且它们共享一个IP地址。HTTP1.1的请求消息和响应消息都应支持Host头域，且请求消息中如果没有Host头域会报告一个错误（400 Bad Request）。</span></span></p></div><h3 id="https://www.notion.so/2301060da6d249ffb96d351f9b579a9b" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/2301060da6d249ffb96d351f9b579a9b"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">*长连接</span></span></h3><div id="https://www.notion.so/deb7e942b17249df849196625cb6487c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">HTTP 1.1支持长连接（PersistentConnection）和请求的流水线（Pipelining）处理，在一个TCP连接上可以传送多个HTTP请求和响应，减少了建立和关闭连接的消耗和延迟，在HTTP1.1中默认开启Connection： keep-alive，一定程度上弥补了HTTP1.0每次请求都要创建连接的缺点。客户端可以控制保持连接的时间，一般不会太长。</span></span></p></div><h2 id="https://www.notion.so/69929cff58e541a1b6ca6e8911217ad2" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/69929cff58e541a1b6ca6e8911217ad2"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">小结</span></span></h2><div id="https://www.notion.so/da9d73cd48f245e0949579917f053137" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">以上都是优化点，关注的比较多的可能是长连接，因为在后续的优化还有涉及。</span></span></p></div><h1 id="https://www.notion.so/aea34c24cebe4979992624f136928162" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/aea34c24cebe4979992624f136928162"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">http2</span></span></h1><div id="https://www.notion.so/fd8c8f4c4ee042feaf021ced2a5ab0ec" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">http2而言，提高性能的主要手段或者说特点有三个：</span></span></p></div><ol class="NumberedListWrapper"><li id="https://www.notion.so/ef79a542b0fe4eb4bc480217779fde39" class="NumberedList" value="1"><span class="SemanticStringArray"><span class="SemanticString">连接复用</span></span></li><li id="https://www.notion.so/98e985325ba44e46a3dc983a30a08020" class="NumberedList" value="2"><span class="SemanticStringArray"><span class="SemanticString">头部压缩</span></span></li><li id="https://www.notion.so/e0bbe9b6aca44ac5b9c5319d93f311ed" class="NumberedList" value="3"><span class="SemanticStringArray"><span class="SemanticString">Server Push</span></span></li></ol><div id="https://www.notion.so/4b0a7dd0dc6941e0a3e3616148329d7e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">其中，前两个已经大规模使用，而Server Push特性由于一些原因并没有大规模使用</span></span></p></div><h2 id="https://www.notion.so/7332a54ddc0d4c2d9440c2b43c917347" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/7332a54ddc0d4c2d9440c2b43c917347"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">连接复用</span></span></h2><div id="https://www.notion.so/fab49dbb985f4a45b942cca289b5fcd4" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">HTTP1的请求，每一次都需要一个TCP连接，对于多个请求来说是一种浪费。HTTP1.1虽然有keep-alive属性，但是他根本上其实是复用TCP连接</span></span></p></div><h3 id="https://www.notion.so/ec31638bcb814fcc80a233d9ff334a65" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/ec31638bcb814fcc80a233d9ff334a65"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">队头阻塞</span></span></h3><div id="https://www.notion.so/a30995b3d4bf4287910721b2b6c4644f" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">http1.1复用TCP连接的时候，多个请求需要排队进行，第二个请求需要等第一个响应之后才能发送，即使二者没有依赖关系。为了实现并行请求，客户端可以建立多个TCP连接来发送多个HTTP请求，但是TCP连接和维护需要成本，一般浏览器以域名维度限制TCP连接的并发数，一般是6.</span></span></p></div><div id="https://www.notion.so/a102769861f141d3aa7c1b4de1047cc0" class="ColorfulBlock ColorfulBlock--BgGray Callout"><div class="Callout__Icon"><div class="Icon">💡</div></div><p class="Callout__Content"><span class="SemanticStringArray"><span class="SemanticString">这就有一种优化方式：把多个请求拆分到不同的域名</span></span></p></div><div id="https://www.notion.so/ba0d1a13ae474ddca1be034b1ef99d9f" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">http2提出了更根本的解决方案：</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">让HTTP在单个TCP连接内可以发送多个请求，并且可以乱序返回</code></span><span class="SemanticString"> </span></span></p></div><div id="https://www.notion.so/b891ca60f1674089bc9a88ed3dc1d043" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fe1ad65fb-cc2f-4bee-9b57-625b2d6286bb%2FUntitled.jpeg?width=2765&amp;table=block&amp;id=b891ca60-f167-4089-bc9a-88ed3dc1d043"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fe1ad65fb-cc2f-4bee-9b57-625b2d6286bb%2FUntitled.jpeg?width=2765&amp;table=block&amp;id=b891ca60-f167-4089-bc9a-88ed3dc1d043" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><h3 id="https://www.notion.so/8c32b4148264444a806e7652c8281a9d" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/8c32b4148264444a806e7652c8281a9d"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">什么情况下不能连接复用</span></span></h3><ol class="NumberedListWrapper"><li id="https://www.notion.so/6289678162a14e9fb043e4ab1c70a2db" class="NumberedList" value="1"><span class="SemanticStringArray"><span class="SemanticString">crossorigin</span></span></li></ol><div id="https://www.notion.so/c249779c6b4241deb85c46abd05e3f43" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">在实践中，有些HTTP请求并不像预期那样复用同一个TCP连接，对其JavaScript代码特点可以发现，它的script标签的差异在于标注了</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">crossorigin</code></span></span></p></div><div id="https://www.notion.so/4a783d99d361423199034d5c08d0ad73" class="ColorfulBlock ColorfulBlock--BgGray Callout"><div class="Callout__Icon"><div class="Icon">💡</div></div><p class="Callout__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">crossorigin</strong></code></span><span class="SemanticString">属性在 </span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/audio"><code class="SemanticString__Fragment SemanticString__Fragment--Code">&lt;audio&gt;</code></a></span><span class="SemanticString">、</span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/img"><code class="SemanticString__Fragment SemanticString__Fragment--Code">&lt;img&gt;</code></a></span><span class="SemanticString">、</span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/link"><code class="SemanticString__Fragment SemanticString__Fragment--Code">&lt;link&gt;</code></a></span><span class="SemanticString">、</span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/script"><code class="SemanticString__Fragment SemanticString__Fragment--Code">&lt;script&gt;</code></a></span><span class="SemanticString">和 </span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/video"><code class="SemanticString__Fragment SemanticString__Fragment--Code">&lt;video&gt;</code></a></span><span class="SemanticString">元素中有效，它们提供对 </span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/CORS">CORS</a></span><span class="SemanticString">的支持，定义该元素如何处理跨源请求，从而实现对该元素获取数据的 CORS 请求的配置。根据元素的不同，该属性可以是一个 CORS 设置属性。
</span></span><div id="https://www.notion.so/f420726cf53447659323f6bebff7217a" class="ColorfulBlock ColorfulBlock--BgGray Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">anonymous</code></span></span></p></div><div id="https://www.notion.so/5edfd013464e4b59ac2e85d22a9933d4" class="ColorfulBlock ColorfulBlock--BgGray Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">请求使用了 CORS 标头，且证书标志被设置为 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">&#x27;same-origin&#x27;</code></span><span class="SemanticString">。没有通过 cookies、客户端 SSL 证书或 HTTP 认证交换</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">用户凭据</strong></span><span class="SemanticString">，除非目的地是同一来源。</span></span></p></div><div id="https://www.notion.so/30c7113dbc4847c0ae03fbf310ed8c41" class="ColorfulBlock ColorfulBlock--BgGray Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">use-credentials</code></span></span></p></div><div id="https://www.notion.so/11bda76f7cd24f61b9a9309c286cb4e0" class="ColorfulBlock ColorfulBlock--BgGray Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">请求使用了 CORS 标头，且证书标志被设置为 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">&#x27;include&#x27;</code></span><span class="SemanticString">。总是包含</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">用户凭据</strong></span><span class="SemanticString">。</span></span></p></div><div id="https://www.notion.so/31c6803ee24843178cd3f59f9be41aed" class="ColorfulBlock ColorfulBlock--BgGray Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">&quot;&quot;</code></span></span></p></div><div id="https://www.notion.so/445a7372c2bd482e9493268012939eaa" class="ColorfulBlock ColorfulBlock--BgGray Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">将属性名称设置为空值，如 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">crossorigin</code></span><span class="SemanticString"> 或 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">crossorigin=&quot;&quot;</code></span><span class="SemanticString">，与设置为 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">anonymous</code></span><span class="SemanticString"> 的效果一样。</span></span></p></div><div id="https://www.notion.so/a7cfcf8f21d04a958d712149c1e0bba3" class="ColorfulBlock ColorfulBlock--BgGray Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">不合法的关键字或空字符串会视为 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">anonymous</code></span><span class="SemanticString"> 关键字。</span></span></p></div><div id="https://www.notion.so/60e893328e7c49ccb0a94aa97c89d3e8" class="ColorfulBlock ColorfulBlock--BgGray Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/0ce8ba85711846c29c5d068fa2caa92b" class="ColorfulBlock ColorfulBlock--BgGray Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">默认情况下（即未指定该属性时），CORS 根本不会使用。

一般来说，</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">crossorigin</code></span><span class="SemanticString">常见的作用是让前端的错误手机系统可以跨域手机JavaScript脚本产生的错误栈</span></span></p></div></p></div><div id="https://www.notion.so/07888dc25f9a49c4ac4c308aee3d5096" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">根据Fetch的标准，一个连接由key、origin和credentials组成，而</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">crossorigin的默认值crossorigin=anonymous代表credentials为false</code></span></span></p></div><div id="https://www.notion.so/12340788826043fb9d48b41ac13554ed" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">对于script来说，默认不加crossorigin的情况下是非CORS请求，是携带credentials，这也是JSONP会携带客户端Cookie的原因</span></span></p></div><div id="https://www.notion.so/e4ef6ff020e74c13a1d16c564783f436" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">这会导致页面上携带和不携带crossorigin的script标签使用不同的连接。</span></span></p></div><div id="https://www.notion.so/3640221deb31413e95e122d600a403da" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><ol class="NumberedListWrapper"><li id="https://www.notion.so/655f651a1fb7428ab0b3dc3b611fe922" class="NumberedList" value="1"><span class="SemanticStringArray"><span class="SemanticString">SSL证书等</span></span></li></ol><div id="https://www.notion.so/3e39276536174f508ec33562d4045175" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">HTTP2的多路复用，复用的是TCP连接，而一个TCP连接是由Client IP、Host IP、Client Port和Host Port四元组确认的，所以即使</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">不同域名，但是是一个Host IP，也可以复用</code></span></span></p></div><div id="https://www.notion.so/bef6960c6bbf4f35b31c222bb7f6a40d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">如果多个连接SSL证书不是同一个，那么也无法复用连接</span></span></p></div><h2 id="https://www.notion.so/4c34f1e93a37483dae7391580114991d" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/4c34f1e93a37483dae7391580114991d"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">头部压缩</span></span></h2><div id="https://www.notion.so/eb113e46cff1470097cf2a45708c418d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">头部体积比较大的主要是Cookie，HTTP2使用了HPACK算法压缩头部体积</span></span></p></div><h2 id="https://www.notion.so/ce0933585f6d48bdb438e729200aa8b0" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/ce0933585f6d48bdb438e729200aa8b0"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">为什么没有广泛使用Server Push</span></span></h2><div id="https://www.notion.so/f9d7ab581d674e869dd0c197876abaf5" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Server Push让服务器吧资源文件和页面一起返回给客户端，以此来提高性能。遇到的问题：</span></span></p></div><h3 id="https://www.notion.so/00907863d6324c478b309f959a7563e5" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/00907863d6324c478b309f959a7563e5"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">资源文件加载</span></span></h3><div id="https://www.notion.so/19e6fec33a114cb8b21f1fa9389e939d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">html页面里有script加载js，这个时候需要加载完html才能请求js</span></span></p></div><div id="https://www.notion.so/ba6f41c2065c43dab193ce0e93b84da6" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">解决办法有几个：</span></span></p></div><ol class="NumberedListWrapper"><li id="https://www.notion.so/79897f3ff21f4d098fcf99d42afe8a2b" class="NumberedList" value="1"><span class="SemanticStringArray"><span class="SemanticString">preload：这个link标签，告知浏览器提前加载。但是preload不会提前执行内容，等html加载完才会起作用，所以需要发起两个请求，节约HTML下载和后续解析消耗的时间</span></span></li><li id="https://www.notion.so/3fe9dfd2b41a44089192ba8bbeb0130e" class="NumberedList" value="2"><span class="SemanticStringArray"><span class="SemanticString">内联：把js内容写在html中，但是这样就无法缓存了</span></span></li><li id="https://www.notion.so/dcdcd8b4102f4d02b0763d57ef4a9e68" class="NumberedList" value="3"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">Server Push</code></span></span></li></ol><div id="https://www.notion.so/45757564b17d4d0a887b5a1b523d2937" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">server收到客户端HTML请求的时候，主动把接下来需要使用的资源推给客户端。但是它同样无法有效的和本地缓存互相利用</span></span></p></div><div id="https://www.notion.so/abb3fddbe19849808ba8420d193e3078" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">并且因为这个特点，无法使用第三方CDN的特点，为了尽快发送而放弃CDN在静态资源托管上的优势，往往是得不偿失的</span></span></p></div><h3 id="https://www.notion.so/e18c9d6753bf426fb9e41bdbe34c9ad8" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/e18c9d6753bf426fb9e41bdbe34c9ad8"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Early Hints</span></span></h3><div id="https://www.notion.so/2a7f7c7094c648b59b372530a902078e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">一个标准的草安，允许服务器在HTML相应还没准备好的情况下先响应一个103，告知浏览器从什么地方提前加载内容</span></span></p></div><div id="https://www.notion.so/d956583f846d4af39ecbb479117ac646" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">这样，客户端可以自行判断本地是否有缓存，相比preload，不需要等待html完全准备完毕</span></span></p></div><h1 id="https://www.notion.so/a5bac1cab7814bba9da635151d1781b1" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/a5bac1cab7814bba9da635151d1781b1"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">HTTP3</span></span></h1><div id="https://www.notion.so/17371f4256d847b686bd442e9b89c170" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">从上面来看，HTTP2已经解决了很多问题，那么为什么还需要引入HTTP3呢？</span></span></p></div><h2 id="https://www.notion.so/44f946cae5054bc8995886ce06478c49" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/44f946cae5054bc8995886ce06478c49"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">HTTP2存在的问题</span></span></h2><div id="https://www.notion.so/3c8a91c7e7ee46f6901185808e772baf" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">无论是http1还是http2，都是基于TCP协议，这意味着TCP协议带来的问题无法解决</span></span></p></div><h3 id="https://www.notion.so/3f14f2dce841452496a5e9a0acd50b20" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/3f14f2dce841452496a5e9a0acd50b20"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">TCP对头阻塞</span></span></h3><div id="https://www.notion.so/cfd167d4d2e2429f8b5f8154f77230af" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fe66c12d5-8925-4751-9670-cf6d94f98fd3%2FUntitled.jpeg?width=2989&amp;table=block&amp;id=cfd167d4-d2e2-429f-8b5f-8154f77230af"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fe66c12d5-8925-4751-9670-cf6d94f98fd3%2FUntitled.jpeg?width=2989&amp;table=block&amp;id=cfd167d4-d2e2-429f-8b5f-8154f77230af" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><h3 id="https://www.notion.so/a19b5d85f63c4efc9580d4a6b3cf4231" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/a19b5d85f63c4efc9580d4a6b3cf4231"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">TCP握手时长</span></span></h3><h3 id="https://www.notion.so/f003daae31ad4c5ea27ac988584333cb" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/f003daae31ad4c5ea27ac988584333cb"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">移动网络切换成本</span></span></h3><div id="https://www.notion.so/7538c70bd7454be3a510049a52675425" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">随着移动用户越来越多，网络环境常常发生变化，那么客户端IP和PORT就会发生变化，这种情况下就会连接失败，需要重新建立连接</span></span></p></div><h2 id="https://www.notion.so/06944d1c6b654d2f9b40fcd73dcb6536" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/06944d1c6b654d2f9b40fcd73dcb6536"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">HTTP3如何解决问题</span></span></h2><div id="https://www.notion.so/a1d98b07f20445b88a1d08f57b254050" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">从上面可以看到，http2的问题不是协议本身，而是TCP的问题，那么主要就是要解决它</span></span></p></div><h3 id="https://www.notion.so/466212ba870049448f35638bd874d1b1" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/466212ba870049448f35638bd874d1b1"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">升级协议是否可行</span></span></h3><div id="https://www.notion.so/e24dedb6b0d841088a0d4fa0e524c334" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">协议传输需要经过很多设备，如果TCP协议有升级，这些设备都需要升级，操作系统需要部署周期</span></span></p></div><h3 id="https://www.notion.so/e044e1bc83744ba69e219415f7569354" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/e044e1bc83744ba69e219415f7569354"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">QUIC over UDP</span></span></h3><div id="https://www.notion.so/b541d4e18e074860a332e5225959d7aa" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">升级不可行，创造新的协议也有一样的问题，剩下的方案就是在UDP上定制协议。</span></span></p></div><div id="https://www.notion.so/210f88cab02143a0890aec31c2177e8e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">QUIC（Quick UDP Internet Connection）：快速UDP互联网连接。TCP被设计为一个管道，并不理解传输的内容，这也是TLS必须在TCP连接的基础上再进行额外的握手，以及HTTP2多路复用无法在丢包的情况下完成乱序响应的原因。而QUIC试图去</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">理解传输的内容</code></span><span class="SemanticString">，因此把</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">协商密钥</code></span><span class="SemanticString">作为协议的一部分</span></span></p></div><h3 id="https://www.notion.so/2d2586b834204b60aad1508494eb4865" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/2d2586b834204b60aad1508494eb4865"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">队头阻塞问题</span></span></h3><div id="https://www.notion.so/3e4a3fdeb25f4aecae93738388cd2f9c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">QUIC提供了类似HTTP2多路复用中的数据流概念，在单个数据流中保证有序交付，而多个数据流之间互不影响</span></span></p></div><h3 id="https://www.notion.so/c07ddaf83cef483e9392d6aaf584cf94" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/c07ddaf83cef483e9392d6aaf584cf94"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">握手耗时</span></span></h3><div id="https://www.notion.so/2b2915734772438d8e37c75edd8873e6" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">QUIC摆脱了TCP的限制，可以把我手和交换密钥房子啊一次完成，从而实现了1个RTT握手</span></span></p></div><h3 id="https://www.notion.so/1f31bbe305104f1389d8f489be9f9421" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/1f31bbe305104f1389d8f489be9f9421"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">移动场景优化</span></span></h3><div id="https://www.notion.so/24d0af15c303434a957f4b9651482cce" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">QUIC针对移动场景常常出现的网络环境变化的情况，支持迁移，也就是当客户端网络IP地址改变以后，也能保持连接不间断</span></span></p></div></article>
  <footer class="Footer">
  <div>&copy; Zhao’s Blog 2022</div>
  <div>&centerdot;</div>
  <div>Powered by <a href="https://github.com/dragonman225/notablog" target="_blank"
      rel="noopener noreferrer">Notablog</a>.
  </div>
</footer>
</body>

</html>